<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">
<!-- 회원가입 -->
<insert id="create" parameterType="MemberDTO">
	insert into portfolio_member(id,passwd,name,year,month,day,nickname,email1,at,email2,
								 zipnumber1,zipnumber2,zipnumber3,phone1,phone2,phone3,zipcode,
								 address1,address2,photo,hobby,grade,cdate,sex)
						  values(#{id},#{passwd},#{name},#{year},#{month},#{day},#{nickname},
						  		 #{email1},#{at},#{email2},#{zipnumber1},#{zipnumber2},#{zipnumber3},
						  		 #{phone1},#{phone2},#{phone3},#{zipcode},#{address1},#{address2},
						  		 #{photo},#{hobby},#{grade},sysdate,#{sex})		 
</insert>
<!-- ID,Email,nickname 중복 -->
<select id="id_Check" parameterType="String" resultType="int">
	select count(id) from portfolio_member
	where id=#{id}
</select>
<select id="nickname_Check">
	select count(nickname) from portfolio_member
	where nickname=#{nickname}
</select>
<select id="login" parameterType="Map" resultType="int">
	select count(id) from portfolio_member
	where id=#{id} and passwd=#{passwd}
</select>
<select id="getGrade" parameterType="String" resultType="String">
	select grade from portfolio_member
	where id=#{id}
</select>
<select id="getPhoto" parameterType="String" resultType="String">
	select photo from portfolio_member
	where id=#{id}
</select>
<select id="read" parameterType="String" resultType="MemberDTO">
	select * from portfolio_member
	where id=#{id}
</select>
<select id="passwdCheck" parameterType="Map" resultType="int">
	select count(id) from portfolio_member
	where id=#{id} and passwd=#{passwd}
</select>
<update id="update" parameterType="MemberDTO">
	update portfolio_member set nickname=#{nickname}, 
	                            email1=#{email1}, 
	                            email2=#{email2},
	                            zipnumber1=#{zipnumber1},
	                            zipnumber2=#{zipnumber2},
	                            zipnumber3=#{zipnumber3},
	                            phone1=#{phone1},
	                            phone2=#{phone2},
	                            phone3=#{phone3},
	                            zipcode=#{zipcode},
	                            address1=#{address1},
	                            address2=#{address2},
	                            hobby=#{hobby}
	               where id=#{id}      
</update>
<update id="fileupdate" parameterType="Map">
	update portfolio_member set photo=#{photo}
	where id=#{id}
</update>
<select id="list" parameterType="Map" resultType="MemberDTO">
	select photo,id,nickname,email1,at,email2,sex,grade,r from(
		select photo,id,nickname,email1,at,email2,sex,grade,rownum r from(
			select photo,id,nickname,email1,at,email2,sex,grade from portfolio_member
		<where>
			<if test="col=='email'">email1 like '%'||#{word}||'%'</if>
			<if test="col=='id'">id like '%'||#{word}||'%'</if>
			<if test="col=='grade'">grade like '%'||#{word}||'%'</if>
			<if test="col=='sex'">sex like '%'||#{word}||'%'</if>
		</where>

		ORDER BY id ASC
		)
		)<![CDATA[where r>=#{sno} and r<=#{eno}  ]]>
</select>

<select id="total" parameterType="Map" resultType="int">
	select count(*) from portfolio_member
		<where>
			<if test="col==''"> </if>
			<if test="col=='email'">email1 like '%'||#{word}||'%'</if>
			<if test="col=='id'">id like '%'||#{word}||'%'</if>
			<if test="col=='grade'">grade like '%'||#{word}||'%'</if>
			<if test="col=='sex'">sex like '%'||#{word}||'%'</if>
		</where>
</select>
</mapper>